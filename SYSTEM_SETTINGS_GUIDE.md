# 系统设置功能指南

## 概述

系统设置功能为管理员提供了完整的系统配置管理能力，包括基本设置、安全设置、专利设置、通知设置和备份设置。

## 功能特性

### 🔧 基本设置

- **系统名称**: 自定义系统显示名称
- **系统版本**: 显示当前系统版本（只读）
- **管理员邮箱**: 设置管理员联系邮箱
- **系统描述**: 添加系统功能描述

### 🔒 安全设置

- **密码最小长度**: 设置用户密码的最小长度要求
- **密码复杂度**: 配置密码必须包含的字符类型
  - 大写字母
  - 小写字母
  - 数字
  - 特殊字符
- **会话超时时间**: 设置用户会话自动超时时间
- **登录失败锁定**: 启用/禁用连续登录失败锁定功能
- **最大登录失败次数**: 设置触发锁定的失败次数

### 📋 专利设置

- **专利号前缀**: 自定义专利号的前缀
- **专利号长度**: 设置专利号的长度
- **自动审核**: 启用/禁用新专利自动进入审核流程
- **专利过期提醒**: 设置专利过期前的提醒天数
- **允许的专利类型**: 配置系统支持的专利类型
  - 发明专利
  - 实用新型
  - 外观设计
  - 软件专利

### 🔔 通知设置

- **邮件通知**: 启用/禁用邮件通知功能
- **系统通知**: 启用/禁用系统内通知功能
- **通知类型**: 配置需要发送通知的事件
  - 专利审核通过
  - 专利审核拒绝
  - 专利即将过期
  - 新用户注册
  - 系统维护

### 💾 备份设置

- **自动备份**: 启用/禁用自动备份功能
- **备份频率**: 设置自动备份的频率（每天/每周/每月）
- **保留备份数量**: 设置保留的备份文件数量
- **立即备份**: 手动触发系统备份
- **恢复备份**: 从备份文件恢复系统设置

## 权限控制

### 访问权限

- **管理员**: 拥有完整的系统设置权限
- **审核员**: 无系统设置权限
- **普通用户**: 无系统设置权限

### 权限检查

- 页面加载时自动检查用户权限
- 无权限用户会被重定向到控制台
- 显示相应的错误提示信息

## 技术实现

### 状态管理

使用 Pinia Store (`useSettingsStore`) 管理所有系统设置：

```typescript
// 获取设置
const settings = settingsStore.getSettings();

// 保存设置
await settingsStore.saveSettings(newSettings);

// 重置设置
settingsStore.resetSettings();
```

### 数据持久化

- 设置自动保存到 localStorage
- 支持导入/导出设置文件
- 页面刷新后自动恢复设置

### 密码验证

集成了基于设置的密码强度验证：

```typescript
const result = settingsStore.validatePassword(password);
if (!result.isValid) {
  console.log("密码错误:", result.errors);
}
```

### 专利号生成

根据设置自动生成专利号：

```typescript
const patentNumber = settingsStore.generatePatentNumber();
```

## 使用方法

### 1. 访问系统设置

1. 登录系统（需要管理员权限）
2. 点击右上角用户头像
3. 选择"系统设置"
4. 或直接访问 `/dashboard/settings`

### 2. 修改设置

1. 在各个设置卡片中修改相应配置
2. 点击"保存设置"按钮
3. 等待保存成功提示

### 3. 重置设置

1. 点击"重置设置"按钮
2. 确认重置操作
3. 设置将恢复为默认值

### 4. 导出设置

1. 点击"导出设置"按钮
2. 系统将下载 JSON 格式的设置文件
3. 文件名包含当前日期

### 5. 备份操作

1. **立即备份**: 点击"立即备份"按钮
2. **恢复备份**: 点击"恢复备份"按钮并确认

## 设置影响

### 密码策略

- 影响新用户注册时的密码要求
- 影响用户修改密码时的验证规则
- 实时验证密码强度

### 专利管理

- 影响新专利的编号生成规则
- 影响专利审核流程的自动化程度
- 影响专利过期提醒的时间

### 通知系统

- 控制各种事件的通知发送
- 影响用户体验和系统交互

### 安全策略

- 影响用户会话管理
- 影响登录安全策略
- 影响系统整体安全性

## 注意事项

1. **权限要求**: 只有管理员可以访问系统设置
2. **数据备份**: 建议定期导出设置文件作为备份
3. **设置影响**: 修改设置可能影响系统运行，请谨慎操作
4. **兼容性**: 设置变更不会影响现有数据，但可能影响新数据的处理

## 故障排除

### 常见问题

1. **无法访问系统设置**

   - 检查用户权限是否为管理员
   - 确认用户已正确登录

2. **设置保存失败**

   - 检查浏览器 localStorage 是否可用
   - 尝试刷新页面后重新保存

3. **设置未生效**
   - 确认设置已成功保存
   - 检查相关功能是否使用了设置值

### 技术支持

如遇到问题，请联系系统管理员或查看系统日志获取详细信息。

---

**版本**: 1.0.0  
**最后更新**: 2024 年 7 月 30 日  
**维护者**: 新浪科技开发团队
